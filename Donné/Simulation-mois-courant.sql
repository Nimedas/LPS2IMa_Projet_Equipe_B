INSERT INTO FAITS_VENTES_STAR
SELECT   "ID_MAGASIN",
    "ID_FAMILLE_PRODUIT",
    (SELECT ID_TEMPS FROM DIM_TEMPS WHERE ANNEE=T1.ANNEE+1 AND MOIS=T1.MOIS) AS "ID_TEMPS",
    "VENTES_OBJECTIF" ,
    "VENTES_REEL" ,
    "CA_OBJECTIF" ,
    "CA_REEL" ,
    "MARGE_OBJECTIF" ,
    "MARGE_REEL" ,
    SYSDATE    
  FROM FAITS_VENTES_STAR,DIM_TEMPS T1
  WHERE FAITS_VENTES_STAR.ID_TEMPS=T1.id_temps
  AND ANNEE=TO_NUMBER(TO_CHAR(SYSDATE,'YYYY'))-1
  AND MOIS<TO_NUMBER(TO_CHAR(SYSDATE,'MM'))
  AND TO_CHAR(SYSDATE,'YYYY')||TRIM(TO_CHAR(MOIS,'09')) NOT IN (SELECT DISTINCT ID_TEMPS FROM FAITS_VENTES_STAR)
  ;